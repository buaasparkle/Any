webpackJsonp([1],{0:function(t,e){},"3tta":function(t,e){},"6gIj":function(t,e){},CguD:function(t,e){},Ij5h:function(t,e){},JAd2:function(t,e){},LBAD:function(t,e){},"N//I":function(t,e){},N8R7:function(t,e){},NHnr:function(t,e,n){"use strict";function r(t,e,n){return t+", params="+w()(e)+", err="+w()(n)}function i(t){return Rt.get(t)}function a(t,e,n){switch(t){case Ut:return e();case Dt:return n();case Ft:return S.a.resolve({})}}function o(t,e){return"../config."+t.appId+"."+t.appConfigId+"/"+e}Object.defineProperty(e,"__esModule",{value:!0});var s=n("7+uW"),u={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{attrs:{id:"app"}},[e("router-view")],1)},staticRenderFns:[]},c=n("VU/8")({name:"app"},u,!1,function(t){n("6gIj")},null,null).exports,d=n("/ocq"),l=n("Dd8w"),f=n.n(l),g=n("Xxa5"),p=n.n(g),h=n("exGp"),m=n.n(h),b=n("+bJm"),v=n.n(b),I=n("//Fk"),S=n.n(I),k=n("mvHQ"),w=n.n(k),y=function(){var t=new Date,e=[t.getHours(),t.getMinutes(),t.getSeconds()].join(":");e+="."+t.getMilliseconds();for(var n=arguments.length,r=Array(n),i=0;i<n;i++)r[i]=arguments[i];r.forEach(function(t){var n=t;n=t instanceof Error?t.name+":"+t.message:"string"==typeof t?t:w()(t),console.log("["+e+"] "+n)})},x=v.a.ClientApi,P={emit:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return new S.a(function(n,i){var a={eventName:t,eventData:e};x.emit(a,function(t,e){if(t)return y(r("emit event failed",a,t)),void i(new Error(t));n(e)})})},createStokePage:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return new S.a(function(e,n){var i={pageCount:t};x.createStokePage(i,function(t,a){if(t)return y(r("create page failed",i,t)),void n(new Error(t));e(a)})})},toggleStrokePageVisible:function(t,e){return new S.a(function(n,i){var a={strokePageId:t,visible:e};x.toggleStrokePageVisible(a,function(t,e){if(t)return y(r("toggle stroke page visible failed",a,t)),void i(new Error(t));n(e.result)})})},toggleForumEnabled:function(t){return new S.a(function(e,n){var i={enable:t};x.toggleForumEnabled(i,function(t,a){if(t)return y(r("toggle forum enabled failed",i,t)),void n(new Error(t));e(a.result)})})},toggleToolbarItemsEnabled:function(t,e){return new S.a(function(n,i){var a={enabledIds:t,disabledIds:e};x.toggleToolbarItemsEnabled(a,function(t,e){if(t)return y(r("toggle toolbar items enabled failed",a,t)),void i(new Error(t));n(e.result)})})}},C=n("NYxO"),_=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return(100*t).toFixed(e)+"%"},z=n("8+8L"),T=n("63KW");s.a.use(z.a);var j={loadLocalFile:function(t){var e=this;return m()(p.a.mark(function n(){var r;return p.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,s.a.http.get(t,{responseType:"arraybuffer"});case 3:return r=e.sent,e.abrupt("return",r.body);case 7:if(e.prev=7,e.t0=e.catch(0),!(0===e.t0.status&&e.t0.body instanceof ArrayBuffer)){e.next=13;break}return e.abrupt("return",e.t0.body);case 13:throw e.t0;case 14:case"end":return e.stop()}},n,e,[[0,7]])}))()},arrayBufferToJson:function(t){if(t instanceof ArrayBuffer){var e=T.Buffer.from(t);return JSON.parse(e.toString())}throw new Error("format error")},calcImgSize:function(t,e,n){var r=this,i=new Image;i.addEventListener("load",function(){var t={width:r.pxToPercentageWidth(i.width*e),height:r.pxToPercentageHeight(i.height*e)};n(t)},!1),i.src=t},pxToPercentageWidth:function(t){return 100*t/780+"%"},pxToPercentageHeight:function(t){return 100*t/585+"%"},pxToVWNumber:function(t){return 100*t/780},toChar:function(t){return String.fromCharCode(t+65)}},O={name:"status-bar",filters:{relativeTime:function(t,e){var n=t>=e,r=Math.abs(t-e),i=Math.floor(r/6e4),a=function(t){return("0"+t).slice(-2)}(Math.round(r%6e4/1e3));return(n?"":"-")+i+":"+a},percentage:_},data:function(){return{now:null,timer:null}},computed:f()({},Object(C.d)("teacher",["bizCreating","waitingBiz","interactionStartTime","totalCount"]),Object(C.c)(["isBeforeInteraction","isInteracting","isAfterInteractionQuestion","isAfterInteractionSolution"]),Object(C.c)("stage",["answer"]),Object(C.c)("teacher",["completedCount","answerDistribution"]),{btnDisabled:function(){return this.bizCreating||this.waitingBiz}}),methods:f()({},Object(C.b)("teacher",["startInteraction","endInteraction","jumpToQuestion","jumpToSolution"]),Object(C.b)("stage",["updateStageShrink"]),{toChar:function(t){return j.toChar(t)},onStartInteraction:function(){var t=this;return m()(p.a.mark(function e(){return p.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.startInteraction();case 2:if(e.sent){e.next=5;break}return e.abrupt("return");case 5:t.updateStageShrink(.7),t.now=(new Date).valueOf(),function e(){t.timer=setTimeout(function(){t.now=(new Date).valueOf(),e()},1e3)}();case 9:case"end":return e.stop()}},e,t)}))()},onEndInteraction:function(){var t=this;return m()(p.a.mark(function e(){return p.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.endInteraction();case 2:if(e.sent){e.next=5;break}return e.abrupt("return");case 5:t.updateStageShrink(1),t.timer&&(clearTimeout(t.timer),t.timer=null);case 7:case"end":return e.stop()}},e,t)}))()}})},A={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"status-bar"},[n("div",{staticClass:"status-bar-content text-muted"},[t.isBeforeInteraction?n("span",[t._v("点击开始测验后，学生可以自主作答本题")]):t.isInteracting?n("span",[t._v("\n            测验已进行 "+t._s(t._f("relativeTime")(t.now,t.interactionStartTime))+"，"+t._s(t.completedCount)+"/"+t._s(t.totalCount)+" 人已完成\n        ")]):n("span",[t._v("\n            选项分布\n            "),t._l(t.answerDistribution,function(e,r){return n("span",{key:r,staticClass:"answer-distribution",class:{correct:t.answer.correctOptionIndex===r}},[t._v("\n                "+t._s(t.toChar(r))+":"+t._s(t._f("percentage")(e.ratio))+"\n            ")])})],2)]),t._v(" "),t.isBeforeInteraction?n("button",{staticClass:"status-bar-btn btn btn-sm btn-light ml-auto",attrs:{type:"button",disabled:t.btnDisabled},on:{click:t.onStartInteraction}},[t._v("开始测验\n    ")]):t._e(),t._v(" "),t.isInteracting?n("button",{staticClass:"status-bar-btn btn btn-sm btn-light ml-auto",attrs:{type:"button",disabled:t.btnDisabled},on:{click:t.onEndInteraction}},[t._v("结束测验\n    ")]):t._e(),t._v(" "),t.isAfterInteractionSolution?n("button",{staticClass:"status-bar-btn btn btn-sm btn-light ml-auto",attrs:{type:"button",disabled:t.btnDisabled},on:{click:t.jumpToQuestion}},[t._v("跳至题目\n    ")]):t._e(),t._v(" "),t.isAfterInteractionQuestion?n("button",{staticClass:"status-bar-btn btn btn-sm btn-light ml-auto",attrs:{type:"button",disabled:t.btnDisabled},on:{click:t.jumpToSolution}},[t._v("跳至答案\n    ")]):t._e()])},staticRenderFns:[]},B=n("VU/8")(O,A,!1,function(t){n("CguD")},"data-v-3d011fd2",null).exports,E=n("woOf"),V=n.n(E),R={name:"stage-title",computed:f()({},Object(C.d)("stage",["titleImgSize"]),Object(C.c)("stage",["titleReady","isImgTitle","isTextTitle","title"]),{styles:function(){var t={};return this.titleReady&&(this.isImgTitle&&(t.top=this.title.top,t.left=this.title.left,t.backgroundImage="url('"+this.title.imgUrl+"')",t.width=this.titleImgSize.width,t.height=this.titleImgSize.height),this.isTextTitle&&(t.top=this.title.top,t.left=this.title.left,t.fontSize=this.title.fontSize+"vw",V()(t,this.title.styles))),t}})},q={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"stage-title-container",style:this.styles},[this.isTextTitle?e("span",[this._v(this._s(this.title.content))]):this._e()])},staticRenderFns:[]},U=n("VU/8")(R,q,!1,function(t){n("N//I")},"data-v-1b790513",null).exports,F={name:"stage-answer",computed:f()({},Object(C.d)("stage",["answerImgSize","optionsImgSize"]),Object(C.c)("stage",["answerReady","answer","options"]),Object(C.c)(["isAfterInteractionSolution"]),{containerStyles:function(){var t={};return this.answerReady&&(t.top=this.answer.top,t.left=this.answer.left,t.width=this.answerImgSize.width,t.height=this.answerImgSize.height),t},bgStyles:function(){var t={};return this.answerReady&&(t.backgroundImage="url('"+this.answer.bgImgUrl+"')"),t},correctStyles:function(){var t={};if(this.answerReady){var e=this.answer.correctOptionIndex,n=this.options[e],r=this.optionsImgSize[e],i=this.fixCorrectAnswerSize(this.answerImgSize,r);t.backgroundImage="url('"+n.imgUrl+"')",t.width=i.width,t.height=i.height,t.transform="translate("+n.translateX+", "+n.translateY+")"}return t}}),methods:{parseSizeNum:function(t){return{width:+t.width.substring(0,t.width.length-1),height:+t.height.substring(0,t.height.length-1)}},fixCorrectAnswerSize:function(t,e){var n=this.parseSizeNum(t),r=this.parseSizeNum(e);return{width:100*r.width/n.width+"%",height:100*r.height/n.height+"%"}}}},D={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"stage-answer-container",style:this.containerStyles},[e("div",{staticClass:"stage-answer-bg-container",style:this.bgStyles}),this._v(" "),this.isAfterInteractionSolution?e("div",{staticClass:"correct-answer-container",style:this.correctStyles}):this._e()])},staticRenderFns:[]},W=n("VU/8")(F,D,!1,function(t){n("OxfX")},"data-v-b79c41a2",null).exports,N={name:"stage-option",props:{index:{type:Number,required:!0}},computed:f()({},Object(C.d)("stage",["optionsImgSize"]),Object(C.c)("stage",["optionsReady","answer","options"]),Object(C.c)(["isAfterInteractionSolution"]),{styles:function(){var t={};if(this.optionsReady){var e=this.options[this.index],n=this.optionsImgSize[this.index];t.top=e.top,t.left=e.left,t.backgroundImage="url('"+e.imgUrl+"')",t.width=n.width,t.height=n.height}return t},hide:function(){if(this.optionsReady&&this.isAfterInteractionSolution)return this.answer.correctOptionIndex===this.index}})},M={render:function(){var t=this.$createElement;return(this._self._c||t)("div",{staticClass:"stage-option-container",class:{hide:this.hide},style:this.styles})},staticRenderFns:[]},L=n("VU/8")(N,M,!1,function(t){n("Ij5h")},"data-v-154679f5",null).exports,Q={name:"teacher-web-app-stage",components:{StageAnswer:W,StageTitle:U,StageOption:L},computed:f()({},Object(C.c)("stage",["bgImgUrl","options"]),{backgroundImage:function(){return this.bgImgUrl?"url('"+this.bgImgUrl+"')":""}})},G={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"stage-container",style:{backgroundImage:this.backgroundImage}},[e("stage-title"),this._v(" "),e("stage-answer"),this._v(" "),this._l(this.options,function(t,n){return e("stage-option",{key:n,attrs:{index:n}})})],2)},staticRenderFns:[]},J=n("VU/8")(Q,G,!1,function(t){n("JAd2")},"data-v-16e99adc",null).exports,$={name:"answer-distribution",filters:{percentage:_},computed:f()({},Object(C.c)("stage",["answer"]),Object(C.c)("teacher",["answerDistribution"])),methods:{toChar:function(t){return j.toChar(t)},toWidth:function(t){return{width:_(t.ratio)}}}},H={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"distribution-container"},[n("div",{staticClass:"title"},[t._v("答案分布：")]),t._v(" "),t._l(t.answerDistribution,function(e,r){return n("div",{key:r,staticClass:"answer-container",class:{correct:t.answer.correctOptionIndex===r}},[n("div",{staticClass:"option"},[t._v("选项"+t._s(t.toChar(r)))]),t._v(" "),n("div",{staticClass:"distribution-chart"},[n("div",{staticClass:"distribution-bar",style:t.toWidth(e)})]),t._v(" "),n("div",{staticClass:"distribution-value"},[t._v(t._s(t._f("percentage")(e.ratio)))])])})],2)},staticRenderFns:[]},X=n("VU/8")($,H,!1,function(t){n("3tta")},"data-v-cf1f2f3c",null).exports,Y={env:"online",apiPrefix:"https://www.yuanfudao.com",galleryPrefix:"https://gallery.fbcontent.cn"};location.hostname.includes("local")?(Y.env="local",Y.apiPrefix="https://ke.yuanfudao.ws",Y.galleryPrefix="https://ytkgallery.yuanfudao.ws"):(location.hostname.includes("ws")||location.hostname.includes("test"))&&(Y.env="test",Y.apiPrefix="https://ke.yuanfudao.ws",Y.galleryPrefix="https://ytkgallery.yuanfudao.ws"),"/"!==Y.apiPrefix[Y.apiPrefix.length-1]&&(Y.apiPrefix+="/");var K=Y,Z=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"ape";return K.galleryPrefix+"/api/"+e+"/images/"+t},tt={name:"student-list",data:function(){return{timer:null}},filters:{galleryImg:Z},computed:f()({},Object(C.c)(["isInteracting","isAfterInteractionSolution"]),Object(C.c)("stage",["answer"]),Object(C.d)("teacher",["students"])),watch:{isInteracting:function(t){var e=this;if(t&&!this.timer){!function t(){e.timer=setTimeout(function(){e.getStudentsStat().then(function(){t()})},2e3)}()}},isAfterInteractionSolution:function(t){t&&this.timer&&(clearTimeout(this.timer),this.timer=null)}},methods:f()({},Object(C.b)("teacher",["getStudentsStat"]),{toChar:function(t){return j.toChar(t)},toImgUrl:function(t){return Z(t)}})},et={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"student-list-container"},t._l(t.students,function(e,r){return n("div",{key:r,staticClass:"student-list-item"},[n("div",{staticClass:"avatar"},[n("img",{attrs:{src:t.toImgUrl(e.avatar)}})]),t._v(" "),n("div",{staticClass:"nickname"},[t._v(t._s(e.nickname))]),t._v(" "),n("div",{staticClass:"answer",class:{correct:t.answer.correctOptionIndex===e.answer}},[t._v("\n            "+t._s(t.toChar(e.answer))+"\n        ")])])}))},staticRenderFns:[]},nt={name:"teacher-web-app",components:{StudentList:n("VU/8")(tt,et,!1,function(t){n("SinT")},"data-v-3d8c45fd",null).exports,AnswerDistribution:X,TeacherWebAppStage:J,StatusBar:B},computed:f()({},Object(C.d)(["firstBizSynced"]),Object(C.c)(["withBizWhenLoad","isInteracting"]),Object(C.c)("stage",{stageReady:"ready"})),watch:{stageReady:function(t){t&&(P.emit("jsReady"),this.withBizWhenLoad||this.init())},isInteracting:function(t){t&&this.createSolutionStrokePage()}},methods:f()({},Object(C.b)(["setFirstBizSynced"]),Object(C.b)("teacher",["init","syncBiz","createSolutionStrokePage","onStrokePageCreated","toggleClientWidgetsEnabledAndStrokePageVisible"])),mounted:function(){var t=this,e=v.a.ClientApi;e.on("active",function(){t.toggleClientWidgetsEnabledAndStrokePageVisible()}),e.on("destroy",function(){e.destroy(),P.emit("end")}),e.on("bizCreated",function(){var e=m()(p.a.mark(function e(n){return p.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.syncBiz(n);case 2:t.firstBizSynced?t.toggleClientWidgetsEnabledAndStrokePageVisible():(t.setFirstBizSynced(),P.emit("ready"));case 3:case"end":return e.stop()}},e,t)}));return function(t){return e.apply(this,arguments)}}()),e.on("strokePageCreated",function(e){var n=e.currentStrokePageIds;t.onStrokePageCreated(n)})}},rt={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"web-app"},[e("div",{staticClass:"left-side",class:{split:this.isInteracting}},[e("div",{staticClass:"teacher-stage-container"},[e("teacher-web-app-stage")],1),this._v(" "),e("div",{staticClass:"answer-distribution-container"},[e("answer-distribution")],1)]),this._v(" "),e("div",{staticClass:"right-side"},[e("student-list")],1),this._v(" "),e("status-bar")],1)},staticRenderFns:[]},it=n("VU/8")(nt,rt,!1,function(t){n("LBAD")},"data-v-6a78c578",null).exports,at={name:"student-web-app-stage",components:{StageAnswer:W,StageTitle:U,StageOption:L},computed:f()({},Object(C.c)("stage",["bgImgUrl","options"]),{backgroundImage:function(){return this.bgImgUrl?"url('"+this.bgImgUrl+"')":""}})},ot={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"stage-container",style:{backgroundImage:this.backgroundImage}},[e("stage-title"),this._v(" "),e("stage-answer"),this._v(" "),this._l(this.options,function(t,n){return e("stage-option",{key:n,attrs:{index:n}})})],2)},staticRenderFns:[]},st={name:"student-web-app",components:{StudentWebAppStage:n("VU/8")(at,ot,!1,function(t){n("wNJe")},"data-v-ae9652e4",null).exports},computed:f()({},Object(C.d)(["firstBizSynced"]),Object(C.c)("stage",{stageReady:"ready"})),methods:f()({},Object(C.b)(["setFirstBizSynced"]),Object(C.b)("student",["syncBiz","toggleClientWidgetsEnabledAndStrokePageVisible"])),watch:{stageReady:function(t){t&&P.emit("jsReady")}},mounted:function(){var t=this,e=v.a.ClientApi;e.on("active",m()(p.a.mark(function e(){return p.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.toggleClientWidgetsEnabledAndStrokePageVisible();case 2:case"end":return e.stop()}},e,t)}))),e.on("destroy",function(){e.destroy(),P.emit("end")}),e.on("bizCreated",function(){var e=m()(p.a.mark(function e(n){return p.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.syncBiz(n);case 2:t.firstBizSynced?t.toggleClientWidgetsEnabledAndStrokePageVisible():(t.setFirstBizSynced(),P.emit("ready"));case 3:case"end":return e.stop()}},e,t)}));return function(t){return e.apply(this,arguments)}}())}},ut={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"student-stage-container"},[e("student-web-app-stage")],1)},staticRenderFns:[]},ct={components:{StudentWebApp:n("VU/8")(st,ut,!1,function(t){n("tO/M")},"data-v-4c0f5af6",null).exports,TeacherWebApp:it},name:"Entry",computed:f()({},Object(C.c)(["isTeacher","isStudent","isLiveCastMode","isPlaybackMode","isDevMode"])),methods:f()({},Object(C.b)("stage",["syncConfig"])),created:function(){this.isDevMode&&v.a.Util.mockByCsi(),this.syncConfig()}},dt={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"web-app-container"},[this.isTeacher?e("teacher-web-app"):this._e(),this._v(" "),this.isStudent?e("student-web-app"):this._e()],1)},staticRenderFns:[]},lt=n("VU/8")(ct,dt,!1,function(t){n("N8R7")},"data-v-2f05a96d",null).exports;s.a.use(d.a);var ft=new d.a({routes:[{path:"/",name:"entry",component:lt}]}),gt=n("bOdI"),pt=n.n(gt),ht="setStatus",mt="setQuestionStrokePageId",bt="setSolutionStrokePageId",vt="setSolutionStrokePageIdDeferred",It="toggleFirstBizSynced",St="toggleBizSyncing",kt="toggleBizCreating",wt="toggleWaitingBiz",yt="setInteractionStartTime",xt="setTotalCount",Pt="setStageConfig",Ct="setStageShrink",_t="setStageTitleImgSize",zt="setStageOptionImgSize",Tt="setStageAnswerImgSize",jt=n("ifoU"),Ot="beforeInteraction",At="interacting",Bt="afterInteractionSolution",Et="afterInteractionQuestion",Vt=[{value:0,name:Ot},{value:1,name:At},{value:2,name:Bt},{value:3,name:Et}],Rt=new(n.n(jt).a)([[Ot,{enabledIds:[0,1,2,4,5,6,7,9,10],disabledIds:[3,8]}],[At,{enabledIds:[],disabledIds:[0,1,2,3,4,5,6,7,8,9,10]}],[Et,{enabledIds:[0,1,2,4,5,6,7,9,10],disabledIds:[3,8]}],[Bt,{enabledIds:[0,1,2,4,5,6,7,9,10],disabledIds:[3,8]}]]),qt={decodePayload:function(t){var e=T.Buffer.from(t,"base64"),n=JSON.parse(e.toString());return n.status=function(t){var e=Vt.find(function(e){return e.value===t});return e?e.name:""}(n.status),n},validateBizPayload:function(t,e){if(!t)return!1;var n=["appId","appVersion","roomId","keynotePageId","appConfigId"].every(function(n){return e[n]===t[n]}),r=function(t){return[Ot,At,Bt,Et].includes(t)}(t.status);return n&&r}},Ut="livecast",Ft="playback",Dt="dev";s.a.use(z.a);var Wt=K.apiPrefix+"tutor-live-box-drag-drop/api/rooms{/roomId}/drag-boxed",Nt=v.a.MockServerApi,Mt=s.a.resource(Wt,{},{_init:{method:"POST",url:""+Wt},_startInteraction:{method:"POST",url:Wt+"{/keynotePageId}/quizzes"},_endInteraction:{method:"POST",url:Wt+"{/keynotePageId}/ended-quizzes"},_jumpToQuestion:{method:"POST",url:Wt+"{/keynotePageId}/jump-to-question"},_jumpToSolution:{method:"POST",url:Wt+"{/keynotePageId}/jump-to-solution"}});Mt.init=function(t,e,n,r,i,o,s){var u=this;return a(t,function(){var t={roomId:e},a={appId:n,appVersion:r,appConfigId:i,keynotePageId:o,questionStrokePageId:s};return u._init(t,a).then(function(t){return t.json()})},function(){return Nt.execApi.apply(Nt,["init"].concat([e,n,r,i,o,s]))})},Mt.startInteraction=function(t,e,n){var r=this;a(t,function(){var t={roomId:e,keynotePageId:n};return r._startInteraction(t,{}).then(function(t){return t.json()})},function(){return Nt.execApi.apply(Nt,["startInteraction"].concat([e,n]))})},Mt.endInteraction=function(t,e,n,r){var i=this;a(t,function(){var t={roomId:e,keynotePageId:n},a={solutionStrokePageId:r};return i._endInteraction(t,a).then(function(t){return t.json()})},function(){return Nt.execApi.apply(Nt,["endInteraction"].concat([e,n,r]))})},Mt.jumpToQuestion=function(t,e,n){var r=this;a(t,function(){var t={roomId:e,keynotePageId:n};return r._jumpToQuestion(t,{}).then(function(t){return t.json()})},function(){return Nt.execApi.apply(Nt,["jumpToQuestion"].concat([e,n]))})},Mt.jumpToSolution=function(t,e,n){var r=this;a(t,function(){var t={roomId:e,keynotePageId:n};return r._jumpToSolution(t,{}).then(function(t){return t.json()})},function(){return Nt.execApi.apply(Nt,["jumpToSolution"].concat([e,n]))})};var Lt=Mt;s.a.use(z.a);var Qt=s.a.resource(K.apiPrefix+"tutor-live-box-drag-drop/api/rooms{/roomId}/drag-boxed");Qt.getStudentsStat=function(t){switch(t){case Ut:case Ft:return S.a.resolve({});case Dt:var e=[{avatar:"1581f9c7bd15c55.jpg",nickname:"Tom Jack",answer:0},{avatar:"1581f9c7bd15c55.jpg",nickname:"林慧",answer:1},{avatar:"1581f9c7bd15c55.jpg",nickname:"李光林爱学习",answer:2},{avatar:"1581f9c7bd15c55.jpg",nickname:"吕伟123",answer:3},{avatar:"1581f9c7bd15c55.jpg",nickname:"贾晓梅",answer:4},{avatar:"1581f9c7bd15c55.jpg",nickname:"王文",answer:5},{avatar:"1581f9c7bd15c55.jpg",nickname:"李恒强",answer:6},{avatar:"1581f9c7bd15c55.jpg",nickname:"董国旗",answer:7}],n=Math.ceil(20*Math.random()),r=n+5,i=new Array(n).fill(0).map(function(){var t=Math.floor(Math.random()*e.length);return e[t]});return S.a.resolve({totalCount:r,students:i})}};var Gt,Jt,$t,Ht=Qt,Xt=n("Zrlr"),Yt=n.n(Xt),Kt=n("wxAW"),Zt=n.n(Kt),te=function(){function t(){var e=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:3e3;Yt()(this,t),this.promise=new S.a(function(t,r){e.timer=setTimeout(function(){r("Timeout")},n),e.resolve=function(){this.clearTimeout(),t.apply(this.promise,arguments)},e.reject=function(){this.clearTimeout(),r.apply(this.promise,arguments)}})}return Zt()(t,[{key:"clearTimeout",value:function(t){function e(){return t.apply(this,arguments)}return e.toString=function(){return t.toString()},e}(function(){this.timer&&clearTimeout(this.timer)})}]),t}(),ee={namespaced:!0,state:{bizCreating:!1,waitingBiz:!1,solutionStrokePageIdDeferred:void 0,interactionStartTime:void 0,totalCount:0,students:[]},getters:{completedCount:function(t){return t.students.length},answerDistribution:function(t,e,n,r){for(var i=r["stage/options"].length,a=new Array(i),o=0;o<i;o++)a[o]={count:0,ratio:0};return t.students.forEach(function(t){var n=t.answer,r=a[n];r.count=r.count+1,r.ratio=r.count/e.completedCount}),a}},mutations:(Gt={},pt()(Gt,kt,function(t,e){t.bizCreating=e}),pt()(Gt,wt,function(t,e){t.waitingBiz=e}),pt()(Gt,vt,function(t,e){t.solutionStrokePageIdDeferred=e}),pt()(Gt,yt,function(t,e){t.interactionStartTime=e}),pt()(Gt,xt,function(t,e){t.totalCount=e}),pt()(Gt,"setStudents",function(t,e){t.students=e}),Gt),actions:{init:function(t){var e=this,n=t.commit,r=t.rootGetters;return m()(p.a.mark(function t(){var i,a,o,s,u,c,d;return p.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n(kt,!0),i=r.mode,a=r.roomId,o=r.appId,s=r.appVersion,u=r.appConfigId,c=r.keynotePageId,d=r.firstStrokePageId,t.prev=8,n(wt,!0),t.next=12,Lt.init(i,a,o,s,u,c,d);case 12:return t.abrupt("return",!0);case 15:return t.prev=15,t.t0=t.catch(8),y("init web app failed, err:",t.t0),n(wt,!1),t.abrupt("return",!1);case 20:return t.prev=20,n(kt,!1),t.finish(20);case 23:case"end":return t.stop()}},t,e,[[8,15,20,23]])}))()},syncBiz:function(t,e){var n=this,r=t.commit,i=(t.rootState,t.rootGetters);return m()(p.a.mark(function t(){var a,o;return p.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(a={root:!0},r(St,!0,a),t.prev=2,o=qt.decodePayload(e.payload),qt.validateBizPayload(o,i)){t.next=7;break}return y("biz is invalid"),t.abrupt("return",!1);case 7:return r(mt,o.questionStrokePageId,a),r(bt,o.solutionStrokePageId,a),r(ht,o.status,a),t.abrupt("return",!0);case 13:return t.prev=13,t.t0=t.catch(2),y("sync biz failed, err:",t.t0),t.abrupt("return",!1);case 17:return t.prev=17,r(wt,!1),r(St,!1,a),t.finish(17);case 21:case"end":return t.stop()}},t,n,[[2,13,17,21]])}))()},toggleClientWidgetsEnabledAndStrokePageVisible:function(t){var e=this,n=t.rootState,r=t.rootGetters;return m()(p.a.mark(function t(){var a,o,s;return p.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,a=i(n.status),o=a.enabledIds,s=a.disabledIds,t.next=4,P.toggleToolbarItemsEnabled(o,s);case 4:if(!r.isBeforeInteraction){t.next=11;break}return t.next=7,P.toggleForumEnabled(!0);case 7:return t.next=9,P.toggleStrokePageVisible(n.questionStrokePageId,!0);case 9:t.next=34;break;case 11:if(!r.isInteracting){t.next=18;break}return t.next=14,P.toggleForumEnabled(!1);case 14:return t.next=16,P.toggleStrokePageVisible(n.questionStrokePageId,!1);case 16:t.next=34;break;case 18:if(!r.isAfterInteractionQuestion){t.next=27;break}return t.next=21,P.toggleForumEnabled(!0);case 21:return t.next=23,P.toggleStrokePageVisible(n.questionStrokePageId,!0);case 23:return t.next=25,P.toggleStrokePageVisible(n.solutionStrokePageId,!1);case 25:t.next=34;break;case 27:if(!r.isAfterInteractionSolution){t.next=34;break}return t.next=30,P.toggleForumEnabled(!0);case 30:return t.next=32,P.toggleStrokePageVisible(n.questionStrokePageId,!1);case 32:return t.next=34,P.toggleStrokePageVisible(n.solutionStrokePageId,!0);case 34:return t.abrupt("return",!0);case 37:return t.prev=37,t.t0=t.catch(0),y("toggle client widget enabled and stroke page visible failed, err:",t.t0),t.abrupt("return",!1);case 41:case"end":return t.stop()}},t,e,[[0,37]])}))()},createSolutionStrokePage:function(t){var e=this,n=t.commit,r=t.state,i=t.rootState;return m()(p.a.mark(function t(){var a,o;return p.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!i.solutionStrokePageId){t.next=2;break}return t.abrupt("return",!0);case 2:if(a=r.solutionStrokePageIdDeferred,t.prev=3,a){t.next=9;break}return a=new te,n(vt,a),t.next=9,P.createStokePage();case 9:return t.next=11,a.promise;case 11:return o=t.sent,n(bt,o,{root:!0}),t.abrupt("return",!0);case 16:return t.prev=16,t.t0=t.catch(3),y("create solution stroke page failed, err:",t.t0),t.abrupt("return",!1);case 20:return t.prev=20,n(vt,void 0),t.finish(20);case 23:case"end":return t.stop()}},t,e,[[3,16,20,23]])}))()},onStrokePageCreated:function(t,e){var n=t.state,r=t.rootState;if(!r.solutionStrokePageId&&n.solutionStrokePageIdDeferred)if(e&&e.length)if(e.includes(r.questionStrokePageId)){var i=e[e.length-1];if(r.questionStrokePageId!==i)n.solutionStrokePageIdDeferred.resolve(i);else{n.solutionStrokePageIdDeferred.reject("the latest stroke page is question stroke page")}}else y("ignore strokePageCreated event because can't find questionStrokePageId");else y("ignore strokePageCreated event because currentStrokePageIds is empty");else y("ignore strokePageCreated event because solutionStrokePageId is exist or deferred is null")},startInteraction:function(t){var e=this,n=t.commit,r=t.rootGetters;return m()(p.a.mark(function t(){return p.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n(kt,!0),t.prev=1,n(wt,!0),t.next=5,Lt.startInteraction(r.mode,r.roomId,r.keynotePageId);case 5:return n(yt,(new Date).valueOf()),t.abrupt("return",!0);case 9:return t.prev=9,t.t0=t.catch(1),y("start interaction failed, err:",t.t0),n(wt,!1),t.abrupt("return",!1);case 14:return t.prev=14,n(kt,!1),t.finish(14);case 17:case"end":return t.stop()}},t,e,[[1,9,14,17]])}))()},endInteraction:function(t){var e=this,n=t.dispatch,r=t.commit,i=t.rootState,a=t.rootGetters;return m()(p.a.mark(function t(){return p.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return r(kt,!0),t.prev=1,r(wt,!0),t.next=5,n("createSolutionStrokePage");case 5:if(t.sent){t.next=7;break}return t.abrupt("return",!1);case 7:return t.next=9,Lt.endInteraction(a.mode,a.roomId,a.keynotePageId,i.solutionStrokePageId);case 9:return t.abrupt("return",!0);case 12:return t.prev=12,t.t0=t.catch(1),y("end interaction failed, err:",t.t0),r(wt,!1),t.abrupt("return",!1);case 17:return t.prev=17,r(kt,!1),t.finish(17);case 20:case"end":return t.stop()}},t,e,[[1,12,17,20]])}))()},jumpToQuestion:function(t){var e=this,n=t.commit,r=t.rootGetters;return m()(p.a.mark(function t(){return p.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n(kt,!0),t.prev=1,n(wt,!0),t.next=5,Lt.jumpToQuestion(r.mode,r.roomId,r.keynotePageId);case 5:return t.abrupt("return",!0);case 8:return t.prev=8,t.t0=t.catch(1),y("jump to question failed, err:",t.t0),n(wt,!1),t.abrupt("return",!1);case 13:return t.prev=13,n(kt,!1),t.finish(13);case 16:case"end":return t.stop()}},t,e,[[1,8,13,16]])}))()},jumpToSolution:function(t){var e=this,n=t.commit,r=t.rootGetters;return m()(p.a.mark(function t(){return p.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n(kt,!0),t.prev=1,n(wt,!0),t.next=5,Lt.jumpToSolution(r.mode,r.roomId,r.keynotePageId);case 5:return t.abrupt("return",!0);case 8:return t.prev=8,t.t0=t.catch(1),y("jump to solution failed, err:",t.t0),n(wt,!1),t.abrupt("return",!1);case 13:return t.prev=13,n(kt,!1),t.finish(13);case 16:case"end":return t.stop()}},t,e,[[1,8,13,16]])}))()},getStudentsStat:function(t){var e=this,n=t.commit,r=t.rootGetters;return m()(p.a.mark(function t(){var i;return p.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,Ht.getStudentsStat(r.mode);case 3:return i=t.sent,n(xt,i.totalCount),n("setStudents",i.students),t.abrupt("return",!0);case 9:return t.prev=9,t.t0=t.catch(0),y("get students stat failed, err:",t.t0),t.abrupt("return",!1);case 13:case"end":return t.stop()}},t,e,[[0,9]])}))()}},strict:!1},ne={namespaced:!0,state:{},getters:{},mutations:{},actions:{syncBiz:function(t,e){var n=this,r=t.commit,i=(t.rootState,t.rootGetters);return m()(p.a.mark(function t(){var a,o;return p.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(a={root:!0},r(St,!0,a),t.prev=2,o=qt.decodePayload(e.payload),qt.validateBizPayload(o,i)){t.next=6;break}return t.abrupt("return",!1);case 6:return r(mt,o.questionStrokePageId,a),r(bt,o.solutionStrokePageId,a),r(ht,o.status,a),t.abrupt("return",!0);case 12:return t.prev=12,t.t0=t.catch(2),y("sync biz failed, err:",t.t0),t.abrupt("return",!1);case 16:return t.prev=16,r(St,!1,a),t.finish(16);case 19:case"end":return t.stop()}},t,n,[[2,12,16,19]])}))()},toggleClientWidgetsEnabledAndStrokePageVisible:function(t){var e=this,n=t.rootState,r=t.rootGetters;return m()(p.a.mark(function t(){return p.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,!r.isBeforeInteraction){t.next=8;break}return t.next=4,P.toggleForumEnabled(!0);case 4:return t.next=6,P.toggleStrokePageVisible(n.questionStrokePageId,!0);case 6:t.next=31;break;case 8:if(!r.isInteracting){t.next=15;break}return t.next=11,P.toggleForumEnabled(!1);case 11:return t.next=13,P.toggleStrokePageVisible(n.questionStrokePageId,!1);case 13:t.next=31;break;case 15:if(!r.isAfterInteractionQuestion){t.next=24;break}return t.next=18,P.toggleForumEnabled(!0);case 18:return t.next=20,P.toggleStrokePageVisible(n.questionStrokePageId,!0);case 20:return t.next=22,P.toggleStrokePageVisible(n.solutionStrokePageId,!1);case 22:t.next=31;break;case 24:if(!r.isAfterInteractionSolution){t.next=31;break}return t.next=27,P.toggleForumEnabled(!0);case 27:return t.next=29,P.toggleStrokePageVisible(n.questionStrokePageId,!1);case 29:return t.next=31,P.toggleStrokePageVisible(n.solutionStrokePageId,!0);case 31:return t.abrupt("return",!0);case 34:return t.prev=34,t.t0=t.catch(0),y("toggle client widget enabled and stroke page visible failed, err:",t.t0),t.abrupt("return",!1);case 38:case"end":return t.stop()}},t,e,[[0,34]])}))()}},strict:!1},re=n("c/Tr"),ie=n.n(re),ae={syncConfig:function(t){var e=this,n=t.commit,r=t.getters,i=t.rootGetters;return m()(p.a.mark(function t(){var a,s,u;return p.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,a=o(i,"config.json"),t.next=4,j.loadLocalFile(a);case 4:return s=t.sent,u=j.arrayBufferToJson(s),n(Pt,u),r.isImgTitle&&j.calcImgSize(r.title.imgUrl,r.title.scale,function(t){n(_t,t)}),r.options.forEach(function(t,e){j.calcImgSize(t.imgUrl,t.scale,function(t){n(zt,{optionIndex:e,size:t})})}),j.calcImgSize(r.answer.bgImgUrl,r.answer.scale,function(t){n(Tt,t)}),t.abrupt("return",!0);case 13:return t.prev=13,t.t0=t.catch(0),y("sync config failed, err:",t.t0),t.abrupt("return",!1);case 17:case"end":return t.stop()}},t,e,[[0,13]])}))()},updateStageShrink:function(t,e){(0,t.commit)(Ct,e)}},oe={namespaced:!0,state:{config:{},shrink:1,titleImgSize:null,optionsImgSize:[],answerImgSize:null},getters:{titleReady:function(t,e){return t.config&&(e.isTextTitle||!!t.titleImgSize)},optionsReady:function(t,e){if(!t.config)return!1;for(var n=e.options.length,r=!1,i=0;i<n&&(r=!!t.optionsImgSize[i],r);i++);return r},answerReady:function(t){return t.config&&!!t.answerImgSize},ready:function(t,e){return e.titleReady&&e.optionsReady&&e.answerReady},bgImgUrl:function(t,e,n,r){if(t.config.backgroundImgName)return o(r,t.config.backgroundImgName)},isImgTitle:function(t){return t.config&&t.config.title&&"img"===t.config.title.type},isTextTitle:function(t){return t.config&&t.config.title&&"text"===t.config.title.type},title:function(t,e,n,r){if(e.isImgTitle&&t.config.title.img){var i=t.config.title.img;return{imgUrl:o(r,i.imgName),top:i.positionTop,left:i.positionLeft,scale:i.scale||1}}if(e.isTextTitle&&t.config.title.text){var a=t.config.title.text;return{content:a.content,top:a.positionTop,left:a.positionLeft,fontSize:j.pxToVWNumber(a.fontSize*t.shrink),styles:a.styles}}},options:function(t,e,n,r){var i=t.config.options;return i?i.map(function(t){return{imgUrl:o(r,t.imgName),top:t.positionTop,left:t.positionLeft,scale:t.scale||1,translateX:t.translateX||0,translateY:t.translateY||0}}):[]},answer:function(t,e,n,r){if(t.config&&t.config.answer){var i=t.config.answer;return{bgImgUrl:o(r,i.backgroundImgName),correctOptionIndex:i.correctOptionIndex,top:i.positionTop,left:i.positionLeft,scale:i.scale||1}}}},mutations:(Jt={},pt()(Jt,Ct,function(t,e){t.shrink=e}),pt()(Jt,Pt,function(t,e){t.config=e}),pt()(Jt,_t,function(t,e){t.titleImgSize=e}),pt()(Jt,zt,function(t,e){var n=e.optionIndex,r=e.size;t.optionsImgSize[n]=r,t.optionsImgSize=ie()(t.optionsImgSize)}),pt()(Jt,Tt,function(t,e){t.answerImgSize=e}),Jt),actions:ae,strict:!1};s.a.use(C.a);var se={status:void 0,questionStrokePageId:void 0,solutionStrokePageId:void 0,bizSyncing:!1,firstBizSynced:!1},ue={appId:function(t){return+t.route.query.appId},appVersion:function(t){return+t.route.query.appVersion},appConfigId:function(t){return t.route.query.appConfigId},roomId:function(t){return+t.route.query.roomId},userId:function(t){return+t.route.query.userId},userRole:function(t){return t.route.query.userRole},mode:function(t){return t.route.query.mode},keynotePageId:function(t){return+t.route.query.keynotePageId},firstStrokePageId:function(t){return+t.route.query.firstStrokePageId},withBizWhenLoad:function(t){return t.route.query.hasOwnProperty("withBiz")},isLiveCastMode:function(t,e){return e.mode===Ut},isPlaybackMode:function(t,e){return e.mode===Ft},isDevMode:function(t,e){return e.mode===Dt},isBeforeInteraction:function(t){return t.status===Ot},isInteracting:function(t){return t.status===At},isAfterInteractionQuestion:function(t){return t.status===Et},isAfterInteractionSolution:function(t){return t.status===Bt},isTeacher:function(t,e){return"teacher"===e.userRole},isStudent:function(t,e){return"student"===e.userRole}},ce=($t={},pt()($t,ht,function(t,e){t.status=e}),pt()($t,mt,function(t,e){t.questionStrokePageId=e}),pt()($t,bt,function(t,e){t.solutionStrokePageId=e}),pt()($t,St,function(t,e){t.bizSyncing=e}),pt()($t,It,function(t,e){t.firstBizSynced=e}),$t),de={setFirstBizSynced:function(t){(0,t.commit)(It,!0)}},le=new C.a.Store({state:se,getters:ue,mutations:ce,actions:de,modules:{teacher:ee,student:ne,stage:oe},strict:!1}),fe=n("9JMe");n("qb6w");window.WebAppApi=v.a.WebAppApi,s.a.config.productionTip=!1,Object(fe.sync)(le,ft),new s.a({el:"#app",router:ft,store:le,template:"<App/>",components:{App:c}})},OxfX:function(t,e){},SinT:function(t,e){},qb6w:function(t,e){},"tO/M":function(t,e){},wNJe:function(t,e){}},["NHnr"]);
//# sourceMappingURL=app.4801b7eb018460e2d0a7.js.map